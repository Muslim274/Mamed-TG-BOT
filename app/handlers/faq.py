"""
–•–µ–Ω–¥–ª–µ—Ä FAQ
"""
from aiogram import Router, types, Dispatcher, F
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup

from app.keyboards.inline import get_faq_menu
from app.config import settings

router = Router()


class FAQStates(StatesGroup):
    waiting_for_question = State()


@router.message(F.text == "‚ùì FAQ")
async def show_faq_menu(message: types.Message):
    """–ü–æ–∫–∞–∑ FAQ –º–µ–Ω—é"""
    text = """
‚ùì <b>–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</b>

–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å:
"""
    await message.answer(
        text,
        parse_mode="HTML",
        reply_markup=get_faq_menu()
    )


@router.callback_query(F.data == "faq:payments")
async def show_payment_faq(callback: types.CallbackQuery):
    """FAQ –æ –≤—ã–ø–ª–∞—Ç–∞—Ö"""
    text = f"""
üíµ <b>–í–æ–ø—Ä–æ—Å—ã –æ –≤—ã–ø–ª–∞—Ç–∞—Ö</b>

<b>‚ùì –ö–∞–∫–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞?</b>
üí¨ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: {settings.MIN_WITHDRAWAL} {settings.CURRENCY}

<b>‚ùì –ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –≤—ã–ø–ª–∞—Ç—ã?</b>
üí¨ –í—ã–ø–ª–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 3-—Ö —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –ø–æ—Å–ª–µ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏

<b>‚ùì –ö–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –≤—ã–≤–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã?</b>
üí¨ –î–æ—Å—Ç—É–ø–Ω—ã –≤—ã–≤–æ–¥—ã —á–µ—Ä–µ–∑ {settings.PAYMENT_PROVIDER}

<b>‚ùì –ï—Å—Ç—å –ª–∏ –∫–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥?</b>
üí¨ –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞–º–∏, –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ø–æ–ª–Ω—É—é —Å—É–º–º—É

<b>‚ùì –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—ã–ø–ª–∞—Ç–∞ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è?</b>
üí¨ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞—è–≤–∫–∏: {settings.SUPPORT_CONTACT}

<b>‚ùì –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –≤—ã–≤–æ–¥–∞?</b>
üí¨ –î–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ –±–æ—Ç–∞
"""
    
    await callback.message.edit_text(
        text,
        parse_mode="HTML",
        reply_markup=get_faq_menu()
    )
    await callback.answer()


@router.callback_query(F.data == "faq:links")
async def show_links_faq(callback: types.CallbackQuery):
    """FAQ –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–∫–∞—Ö"""
    text = """
üîó <b>–í–æ–ø—Ä–æ—Å—ã –æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–∫–∞—Ö</b>

<b>‚ùì –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞?</b>
üí¨ –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ –≤–∞—à–µ–π —Å—Å—ã–ª–∫–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è cookie –Ω–∞ 30 –¥–Ω–µ–π. –ï—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ —Å–æ–≤–µ—Ä—à–∏—Ç –ø–æ–∫—É–ø–∫—É –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–º–∏—Å—Å–∏—é

<b>‚ùì –ú–æ–∂–Ω–æ –ª–∏ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫?</b>
üí¨ –£ –≤–∞—Å –æ–¥–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å UTM-–º–µ—Ç–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

<b>‚ùì –ö–∞–∫ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–µ–ª –∫–ª–∏–µ–Ω—Ç?</b>
üí¨ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ UTM-–º–µ—Ç–∫–∏: ?utm_source=instagram&utm_campaign=stories

<b>‚ùì –ß—Ç–æ –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –æ—á–∏—Å—Ç–∏—Ç cookies?</b>
üí¨ –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏–≤—è–∑–∫–∞ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –±—ã—Å—Ç—Ä—É—é –ø–æ–∫—É–ø–∫—É

<b>‚ùì –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å—Å—ã–ª–∫–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö?</b>
üí¨ –î–∞, —Å—Å—ã–ª–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É, –∫–æ–º–∏—Å—Å–∏—è –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Å –ª—é–±—ã—Ö –ø—Ä–æ–¥–∞–∂
"""
    
    await callback.message.edit_text(
        text,
        parse_mode="HTML",
        reply_markup=get_faq_menu()
    )
    await callback.answer()


@router.callback_query(F.data == "faq:stats")
async def show_stats_faq(callback: types.CallbackQuery):
    """FAQ –æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ"""
    text = """
üìä <b>–í–æ–ø—Ä–æ—Å—ã –æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ</b>

<b>‚ùì –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞?</b>
üí¨ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∏–∫–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –ø—Ä–æ–¥–∞–∂–∏ - –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç

<b>‚ùì –ü–æ—á–µ–º—É –Ω–µ –≤—Å–µ –∫–ª–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∂–∏?</b>
üí¨ –°—Ä–µ–¥–Ω—è—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è 2-5% —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π. –ú–Ω–æ–≥–æ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏

<b>‚ùì –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"?</b>
üí¨ –≠—Ç–æ –ø—Ä–æ–¥–∞–∂–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å. –û–±—ã—á–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ 24 —á–∞—Å–æ–≤

<b>‚ùì –ú–æ–≥—É—Ç –ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—É—é –ø—Ä–æ–¥–∞–∂—É?</b>
üí¨ –¢–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ç–æ–≤–∞—Ä–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π

<b>‚ùì –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏?</b>
üí¨ –ü–æ–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ. –†–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
"""
    
    await callback.message.edit_text(
        text,
        parse_mode="HTML",
        reply_markup=get_faq_menu()
    )
    await callback.answer()


@router.callback_query(F.data == "faq:tech")
async def show_tech_faq(callback: types.CallbackQuery):
    """FAQ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã"""
    text = """
üõ† <b>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã</b>

<b>‚ùì –ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∞–π—Ç—É –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏?</b>
üí¨ –ù–∏–∫–∞–∫–∏—Ö –æ—Å–æ–±—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –Ω–µ—Ç. –°—Å—ã–ª–∫—É –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—â–∞—Ç—å –Ω–∞ –ª—é–±—ã—Ö —Å–∞–π—Ç–∞—Ö, –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö, –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö

<b>‚ùì –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –≤ —Ä–µ–∫–ª–∞–º–µ?</b>
üí¨ –î–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ª—é–±—ã—Ö –≤–∏–¥–∞—Ö —Ä–µ–∫–ª–∞–º—ã: –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è, —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, –Ω–∞—Ç–∏–≤–Ω–∞—è

<b>‚ùì –ë–ª–æ–∫–∏—Ä—É—é—Ç –ª–∏ —Å–æ—Ü—Å–µ—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏?</b>
üí¨ –ù–∞—à–∏ —Å—Å—ã–ª–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è. –î–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–∫—Ä–∞—â–∞—Ç–µ–ª–∏ —Å—Å—ã–ª–æ–∫

<b>‚ùì –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç —Å–∫–ª–∏–∫–∏–≤–∞–Ω–∏—è?</b>
üí¨ –ú—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞–∫—Ä—É—Ç–∫—É

<b>‚ùì –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ –º–æ–±–∏–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫?</b>
üí¨ –î–∞, —Å–∞–π—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ –Ω–µ –Ω–∏–∂–µ –¥–µ—Å–∫—Ç–æ–ø–∞
"""
    
    await callback.message.edit_text(
        text,
        parse_mode="HTML",
        reply_markup=get_faq_menu()
    )
    await callback.answer()


@router.callback_query(F.data == "faq:ask")
async def ask_question(callback: types.CallbackQuery, state: FSMContext):
    """–ó–∞–¥–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å"""
    text = """
‚ûï <b>–ó–∞–¥–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å</b>

–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å, –∏ –º—ã –ø–µ—Ä–µ–¥–∞–¥–∏–º –µ–≥–æ –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

–ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ.
"""
    await callback.message.edit_text(text, parse_mode="HTML")
    await state.set_state(FAQStates.waiting_for_question)
    await callback.answer()


@router.message(FAQStates.waiting_for_question)
async def process_user_question(message: types.Message, state: FSMContext):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    question = message.text
    user_id = message.from_user.id
    username = message.from_user.username or "–ë–µ–∑ username"
    
    # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ–ø—Ä–æ—Å –≤ –ë–î –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    admin_text = f"""
üì© –ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

üë§ User ID: {user_id}
üë§ Username: @{username}

‚ùì –í–æ–ø—Ä–æ—Å:
{question}
"""
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å ADMIN_ID –≤ –∫–æ–Ω—Ñ–∏–≥)
    # await bot.send_message(ADMIN_ID, admin_text)
    
    await message.answer(
        "‚úÖ –í–∞—à –≤–æ–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤–∞–º –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É.",
        reply_markup=get_faq_menu()
    )
    await state.clear()


def register_faq_handlers(dp: Dispatcher):
    """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤ –º–æ–¥—É–ª—è FAQ"""
    dp.include_router(router)